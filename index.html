<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <title>
  Twittler
  </title>
  <body>
    <script>
      $(document).ready(function(){
        var $body = $('body');
        
        setInterval(function(){
          // $body.html('<h1> Your stream on Twittler! </h1>');
          // $body.empty();
          var index = streams.home.length - 1;
          var cutoff=index-20;
          // console.log(streams.home[index].created_at.getTime());
          while(index >= cutoff && index >=0){
            var tweet = streams.home[index];
            var $tweet = $('<div>+index+</div>');
            // $tweet[name]=index;
            // console.log(new Date().getTime());
            // console.log($tweet);
            var writeup=function(){
              var elapsed=(new Date().getTime()-tweet.created_at.getTime())/1000;
            if (elapsed<10){
              return "Just now..."
            }
            else{
              if (elapsed<40){
                return "A few seconds ago";
              }
              if (elapsed<70){
                return "A minute ago";
              }
              if (elapsed<120){
                return "A couple minutes ago";
              }
              else{
                return "A few minutes ago";
              }

            }
          };
            $tweet.text(index+'indx'+writeup()+'  @' + tweet.user + ': ' + tweet.message);
            $tweet.appendTo($body);
            index -= 1;
            // $( "div" ).remove( ":contains('"+index+"')" );
            console.log('cutoff',cutoff);
            $( "div" ).remove( ":contains('"+cutoff+"')" );
          }
        },3000);

      });

    </script>
  </body>
</html>
